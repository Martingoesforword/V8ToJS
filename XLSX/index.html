<html>

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
</head>

<body>
  <a id="a">21323</a>
</body>
<script src="./jszip.js"></script>
<script src="./_jszip.js"></script>
<script src="./_xlsx.js"></script>
<script>
  let workbook = {
    SheetNames: ["sheet"],
    Sheets: {
      sheet: {
        "!ref": "A1:C3",
        A1: { v: "标题1", t: "s" },
        A2: { v: "1", t: "s" },
        A3: { v: "4", t: "s" },
        B1: { v: "标题2", t: "s" },
        B2: { v: "2", t: "s" },
        B3: { v: "5", t: "s" },
        C1: { v: "标题3", t: "s" },
        C2: { v: "3", t: "s" },
        C3: { v: "6", t: "s" }
      }
    },
    Props: {}
  };

  let wopts = {
    bookType: "xlsx", // 要生成的文件类型
    bookSST: false, // 是否生成Shared String Table，官方解释是，如果开启生成速度会下降，但在低版本IOS设备上有更好的兼容性
    type: "binary",
  };
  function s2ab(s) {
    var buf = new ArrayBuffer(s.length);
    var view = new Uint8Array(buf);
    for (var i=0; i!=s.length; ++i) view[i] = s.charCodeAt(i) & 0xFF;
    return buf;
  }

  // console.log(XLSX.write(workbook, wopts));
  // XLSX2.write(workbook, wopts).then(string => {
  //   let blob = new Blob([s2ab(string)], {type:"application/octet-stream"});
  //   let url = URL.createObjectURL(blob);
  //   a.href= url;
  //   a.download = "123.xlsx";
  //   a.click();
  // });
  // let f1 = XLSX.write(workbook, wopts).files;
  // let f2 = XLSX2.write(workbook, wopts);
  // let l = Object.keys(f1);
  // let i = 8;
  // let s1 = f1[l[i]]._data;
  // let s2 = f2[l[i]]._data;
  // console.log(s1 === s2);
  // console.log(s1);
  // console.log(s2);
  // let wb = XLSX.write(workbook, wopts);
  let wb = XLSX2.write(workbook, wopts);
  // let blob = new Blob([s2ab(wb)], {type:"application/octet-stream"});
  // let url = URL.createObjectURL(blob);
  // a.href= url;
  // a.download = "123.xlsx";
  // a.click();
</script>
</body>
</html>